---
title: 微信小程序
tags: 小程序
categories: 小程序
---

> 即微信环境普通类型小程序



## 一、简介


微信环境中加载的一个轻应用程序，可以把app的功能集成到小程序中，然后用户就可以在微信中实现app的基本功能。


简单理解就是：小程序，相当于app；而微信，就是小程序的appStore。


## 二、准备阶段


### 账号


> 首先得有个小程序了~



在 [微信公众平台](https://mp.weixin.qq.com/) 找到“注册”入口，选择“小程序”进行注册。


这里注意：如果是主体是个人，需要自己的身份信息；如果主体是企业，则需要相关的企业资质材料，提交资质认证时，需要300大洋给微信，另外，小程序名称一定得想好，如果变更的话，也是需要300重新认证。


注册完成，登录之后即可看到小程序相关信息。在我们的业务场景中，关注较多的是“管理”“开发”“设置”菜单，建议多熟悉每个菜单中的设置项。


![微信公众平台常用菜单.png](https://cdn.nlark.com/yuque/0/2021/png/12735713/1615019232344-089ea5e2-19b9-4b43-b477-af44e48aab71.png)


### 开发者权限


小程序的账号和个人微信绑定，用户角色有管理员、运营者、开发者、数据分析者。


小程序的账号申请者即为管理员。


参与小程序开发的成员，必须要有开发者权限，需要管理员在“管理 - 成员管理”菜单将个人微信添加为开发者。


## 三、开发阶段


### 开发者工具


小程序开发需要使用 [微信开发者工具](https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html)，可以下载安装


### 创建小程序项目


安装完成之后，需要微信扫码登录一下，然后，就可以开始创建小程序项目。


![创建小程序项目.png](https://cdn.nlark.com/yuque/0/2021/png/12735713/1615013828387-c75b3a4a-59d6-416c-bc47-7e2de5130f00.png)


创建时需要有AppID，可以在微信公众平台选择小程序登录后，通过“设置-基本设置”菜单找到当前小程序的AppID。


> 请注意：如果只能看到原始ID，并没有AppID，那就是跳过了一些小程序认证，老老实实完成吧~



![查看AppID.png](https://cdn.nlark.com/yuque/0/2021/png/12735713/1615014155517-768a6a52-a3a2-4abe-b55e-669dfc17b189.png)


如果创建时提示不是该小程序的开发者或者没有开发者权限，请联系管理员添加~


创建完成之后，即可看到demo页面！


### 项目配置


在根目录中，可以看到 `project.config.json` 文件，主要是对当前小程序项目的配置，也可以理解为当前项目开发工具配置，为了保持多个开发者、多个开发工具展示统一。比如小程序appid、项目名称、项目描述、版本库、编译模式、编辑器设置等。


修改完成之后，即可在开发者工具菜单栏 - 详情（一般在右上角），看到当前小程序的相关信息。


这里注意：


- `appid` ：小程序的appid，也就是在创建项目时填入的AppID；开发者工具就是根据这个来匹配对应小程序，一定要配置正确，否则小程序将无法运行。
- `projectname`：只是当前项目的名称，和小程序名称以及小程序顶部栏标题没有关系。



![创建项目成功.png](https://cdn.nlark.com/yuque/0/2021/png/12735713/1615015761943-f9aa9796-aabb-4ea1-9370-a6b18caf384f.png)


### 全局配置及入口逻辑


- `app.json`：小程序的全局配置，比如小程序的页面路由、外观样式（顶部栏标题及颜色、背景主题及颜色等）、tabbar、网络请求时长、授权提示、插件、公共组件等。
- `app.js`：小程序入口文件，可以监听小程序启动、切换前后台等生命周期；同时可以设置全局变量，比如 `globalData`，在页面中就可以通过app实例获取到全局数据。
- `app.wxss`：全局样式，可以统一标签样式、声明公共样式类等。



### 页面开发


全局配置完成之后，就可以根据业务需求完成页面开发了！


开发过程中需要注意：


##### 1、可信域名配置：


前后端交互，肯定会有接口请求、上传下载资源；有可能还会有socket通信、web-view嵌套H5页面等。


这一类的域名，都需要在“微信公众平台 - 开发 - 开发管理 - 开发设置”中配置相关可信域名。


![域名配置.png](https://cdn.nlark.com/yuque/0/2021/png/12735713/1615019262072-c3532cc9-43de-444b-9f3a-d536c433dfb8.png)


配置完成之后，可以在“开发者工具 - 详情 - 项目配置”中看到配置成功的域名信息。


![域名配置成功.png](https://cdn.nlark.com/yuque/0/2021/png/12735713/1615016066086-0affb64e-f466-47d3-a04f-3adb3b104f8c.png)


##### 2、包内存大小限制：


小程序会限制每个包大小， 注意控制资源内存，尤其是本地图片一定要压缩。必要时建议分包，减少每个包内存，同时可以提升用户体验！


## 四、体验阶段


### 版本概念


开发预览版 - 开发版本 - 体验版本 - 审核版本 - 线上版本


### 开发预览


在我们的开发完成后，需要通过真机来体验。那就可以“预览”生成一个二维码（这个码会上传到微信服务器），然后用真机微信来扫码即可。


同时，我们也可以把这个二维码发给其他开发者，体验我们当前的版本。


在这个码的有效期内，都可以一直访问；当更改了代码，再次预览又会生成新的二维码。


那么，其实就可以理解为是一个有时效的“开发预览版”。


> 注意：如果小程序涉及到分享功能，那接收到小程序消息的用户，直接打开我们的页面，就会默认是线上已发布的或者之前体验过的版本，并不是当前开发最新版。为了保证体验的是同一个版本，就必须先扫描二维码，然后再打开小程序消息才可以（注意：开发预览码只能给开发者使用，接收者要扫码的话需要有开发者权限）。



![预览生成二维码.png](https://cdn.nlark.com/yuque/0/2021/png/12735713/1615016784069-3d6d8247-1eda-4a34-b2f0-02252de58644.png)


### 上传开发版


> 小程序不同于我们常规的web项目需要打包部署，而是将小程序代码上传到微信公众平台，审核通过并发布后，用户访问时会加载对应版本的小程序。
> 

> 其实这就是“小”程序的概念：常规app是需要下载安装的，“小”程序也需要下载，只是体积比较小，并且运行在特定的app环境中了而已，如果不想使用，直接移出（卸载）即可。微信公众平台的“背后”肯定还有个“应用市场”。



当完成业务需求，并且真机预览OK后，就可以上传代码到微信公众平台了。


操作方法：


- 开发者工具 - 上传 - 填写对应的版本号及描述 - 确认上传
- 上传成功之后，登录微信公众平台
- 管理 - 版本管理，即可以看到已经上传到“开发版本”



![开发者工具上传代码.png](https://cdn.nlark.com/yuque/0/2021/png/12735713/1615017056755-471654ee-486f-4869-ab72-0c6b01c39a09.png)


![上传成功.png](https://cdn.nlark.com/yuque/0/2021/png/12735713/1615019295566-ca020293-7595-41b9-9470-38c564db5e22.png)


### 配置体验版


为什么需要体验版？其实主要是开发版一直在变更，很不稳定；测试、产品同学在验收时，需要的是一个稳定的版本。


操作方法：


- 在刚刚的“微信公众平台 - 开发版本”中，选择一个可以验收的版本，设置“选为体验版”即可
- 设置为体验版的版本，可以看到标识




![选为体验版.png](https://cdn.nlark.com/yuque/0/2021/png/12735713/1615019330895-87ff48e9-7127-4f86-b364-0c3370793033.png)

![生成体验版.png](https://cdn.nlark.com/yuque/0/2021/png/12735713/1615017584740-552dd550-5160-4129-b770-83b2018d2b08.png)

![体验版标识.png](https://cdn.nlark.com/yuque/0/2021/png/12735713/1615017585987-7e70a39e-c8e2-414c-a09d-b2a674b1b678.png)


## 五、发布阶段


### 提交审核


在开发、测试、体验OK之后，那也就意味着该版本可以上线了~


不过，刚刚已经提到了，“小程序不是我们想上线就可以上”，审核是很重要一个环节！！！


操作方法：选择验收完成的开发版或体验版，“提交审核”！


> 这里需要注意：在提审之前，一定要确认自己的小程序是否可以通过审核:
> - 小程序页面功能是否OK？比如是否有demo页面、交互阻塞、请求报错等？
> - 页面中是否有敏感信息？
> - 页面中是否涉及资质认证，比如新闻资讯、理财、直播等，小程序有资质认证吗？
> - ...
> - 确认没有问题！提审！然后就会在审核版本列表中看到~



![提交审核.png](https://cdn.nlark.com/yuque/0/2021/png/12735713/1615019381646-bf02a732-113e-403a-92e7-a177b3a1dadf.png)


### 发布


通过审核之后，一定不要忘了点 “发布”！


发布成功之后，就可以在微信中访问啦~



---

> OK，以上就是普通微信小程序的开发流程了~

## 六、流程总结


- 申请小程序
- 开发者工具创建小程序项目、配置全局文件、实现业务
- 开发者微信扫码预览
- 开发者工具提交代码到微信公众平台
- 微信公众平台选择一个开发版生成体验版
- 验证完成之后提交微信审核
- 审核通过，发布
- 微信访问



